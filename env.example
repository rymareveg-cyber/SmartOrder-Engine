# Переменные окружения для SmartOrder Engine
# Скопируйте этот файл в .env и заполните реальными значениями

# ===========================================
# 1С:Управление нашей фирмой
# ===========================================
# Базовый URL 1С HTTP Service
# Пример: http://1c-server:80 или http://192.168.1.100:80
# Если используется Universal 1C HTTP API Bridge, endpoint будет: /hs/api/get/catalog/
# Примечание: порт 80 - стандартный HTTP порт, может быть опущен в URL
ONEC_BASE_URL=http://localhost:80

# Учетные данные для Basic Auth
ONEC_USERNAME=admin
ONEC_PASSWORD=password

# Endpoint для экспорта счетов в 1С
# Пример: /hs/invoices или /hs/api/post/create_invoice/
ONEC_INVOICES_ENDPOINT=/hs/invoices

# ===========================================
# База данных PostgreSQL
# ===========================================
# Строка подключения к PostgreSQL
# Формат: postgresql://user:password@host:port/database
# Пример: postgresql://smartorder:password@localhost:5432/smartorder
DATABASE_URL=postgresql://smartorder:password@localhost:5432/smartorder

# ===========================================
# Redis
# ===========================================
# Строка подключения к Redis (опционально, для кэширования)
# Формат: redis://host:port/db
# Пример: redis://localhost:6379/0
# Если Redis недоступен, кэширование отключится автоматически
REDIS_URL=redis://localhost:6379/0

# ===========================================
# Настройки синхронизации каталога
# ===========================================
# Интервал синхронизации каталога из 1С (в минутах)
# Рекомендуемое значение: 30 минут
SYNC_INTERVAL_MINUTES=30

# TTL кэша в Redis (в секундах)
# Рекомендуемое значение: 300 секунд (5 минут)
CACHE_TTL=300

# ===========================================
# Логирование
# ===========================================
# Уровень логирования: DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO

# Формат логирования: true (JSON в файлах) или false (текст)
# JSON формат используется для файлов, консоль всегда в читаемом формате
LOG_JSON_FORMAT=true

# ===========================================
# API Server
# ===========================================
# Порт для FastAPI сервера каталога
API_PORT=8025

# Хост для FastAPI сервера
API_HOST=0.0.0.0

# ===========================================
# Telegram Bot
# ===========================================
# Токен бота от @BotFather
# Получить можно здесь: https://t.me/BotFather
TELEGRAM_BOT_TOKEN=your-telegram-bot-token-here

# ID администратора для уведомлений об ошибках
# Узнать свой ID можно через @userinfobot
TELEGRAM_ADMIN_ID=your-telegram-admin-id-here

# ===========================================
# Яндекс.Почта IMAP
# ===========================================
# IMAP сервер Яндекс.Почты
YANDEX_MAIL_IMAP_HOST=imap.yandex.ru

# Email для мониторинга входящих писем
YANDEX_MAIL_EMAIL=your-email@yandex.ru

# Пароль от почты или app password
# Для Яндекс.Почты рекомендуется использовать app password
# Настройки → Пароли и авторизация → Пароли приложений
YANDEX_MAIL_PASSWORD=your-password-or-app-password

# Папка для мониторинга (по умолчанию INBOX)
YANDEX_MAIL_FOLDER=INBOX

# Интервал опроса писем в секундах (по умолчанию 120 секунд = 2 минуты)
YANDEX_MAIL_POLL_INTERVAL=120

# Whitelist отправителей (опционально, через запятую)
# Если указан, обрабатываются только письма от этих адресов
# Пример: YANDEX_MAIL_WHITELIST=client1@example.com,client2@example.com
# YANDEX_MAIL_WHITELIST=

# Ключевые слова в теме письма (опционально, через запятую)
# Если указаны, обрабатываются только письма с этими словами в теме
# Пример: YANDEX_MAIL_SUBJECT_KEYWORDS=заказ,order,товар
# YANDEX_MAIL_SUBJECT_KEYWORDS=

# ===========================================
# Яндекс.Формы Webhook
# ===========================================
# Секретный ключ для проверки подписи запросов (опционально)
# Если Яндекс.Формы поддерживают подпись запросов, укажите секретный ключ
# YANDEX_FORMS_SECRET=your-secret-key-here

# Порт для webhook сервера (по умолчанию 8026)
WEBHOOK_PORT=8026

# Хост для webhook сервера
WEBHOOK_HOST=0.0.0.0

# Настройки rate limiting
# Максимальное количество запросов в минуту на IP (по умолчанию 100)
RATE_LIMIT_REQUESTS=100

# Окно времени для rate limiting в секундах (по умолчанию 60)
RATE_LIMIT_WINDOW=60

# ===========================================
# OpenAI / AI Parser
# ===========================================
# API ключ OpenAI
# Получить можно здесь: https://platform.openai.com/api-keys
OPENAI_API_KEY=your-openai-api-key-here

# Модель для использования (по умолчанию gpt-4.1-mini)
OPENAI_MODEL=gpt-4.1-mini

# BASE URL для OpenAI API (прокси)
# Используется для работы через прокси-сервер
OPENAI_BASE_URL=https://api.proxyapi.ru/openai/v1

# ===========================================
# Queue Processor
# ===========================================
# URL AI-парсера (для Этапа 3)
# Пока не используется, будет реализован на Этапе 3
AI_PARSER_URL=http://localhost:8001

# Количество параллельных воркеров для обработки очереди (по умолчанию 5)
WORKER_CONCURRENCY=5

# Порт для health check endpoint (по умолчанию 8027)
HEALTH_CHECK_PORT=8027

# Хост для health check endpoint
HEALTH_CHECK_HOST=0.0.0.0

# ===========================================
# Безопасность (для будущих этапов)
# ===========================================
# API Key для защиты endpoints (опционально)
# API_KEY=your-secret-api-key-here

# JWT Secret (для будущей аутентификации)
# JWT_SECRET=your-jwt-secret-key-here

# ===========================================
# Доставка
# ===========================================
# Правила расчёта доставки (опционально, JSON формат)
# Если не указано, используются правила по умолчанию
# DELIVERY_RULES_JSON={"москва":{"weight_ranges":[{"max_weight":5.0,"cost":500,"days":1}]}}

# ===========================================
# Генерация счётов (Invoice Generator)
# ===========================================
# Название компании для счёта
COMPANY_NAME=ООО "Ваша Компания"

# ИНН компании
COMPANY_INN=1234567890

# КПП компании
COMPANY_KPP=123456789

# Адрес компании
COMPANY_ADDRESS=г. Москва, ул. Примерная, д. 1

# ===========================================
# Dashboard для менеджера
# ===========================================
# Порт для Dashboard API
# По умолчанию: 8028 (отдельный порт для dashboard)
DASHBOARD_PORT=8028

# Хост для Dashboard API
# По умолчанию: 0.0.0.0 (все интерфейсы)
DASHBOARD_HOST=0.0.0.0
