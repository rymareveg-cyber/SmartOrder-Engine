# SmartOrder Engine

AI-—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–∫–∞–∑–æ–≤ –≤ e-commerce —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π 1–°:–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—à–µ–π —Ñ–∏—Ä–º–æ–π.

–°–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–∫–∞–∑—ã –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ (Telegram, –Ø–Ω–¥–µ–∫—Å.–ü–æ—á—Ç–∞, –Ø–Ω–¥–µ–∫—Å.–§–æ—Ä–º—ã), –ø–æ–Ω–∏–º–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ —Å –ø–æ–º–æ—â—å—é GPT-4, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç –∑–∞–∫–∞–∑—ã –≤ CRM –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ–º –æ—Ç –∑–∞—è–≤–∫–∏ –¥–æ –æ–ø–ª–∞—Ç—ã –∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ —Å—á—ë—Ç–∞ –≤ 1–°.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.11+
- PostgreSQL 14+
- Redis 7+
- 1–°:–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—à–µ–π —Ñ–∏—Ä–º–æ–π —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º HTTP Service
- OpenAI API –∫–ª—é—á (–¥–ª—è AI-–ø–∞—Ä—Å–∏–Ω–≥–∞)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
```bash
pip install -r requirements.txt
```

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
```bash
cp env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª —Å –≤–∞—à–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
```

3. **–°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:**
```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ PostgreSQL –∏ —Å–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
createdb smartorder

# –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
psql -d smartorder -f database/migrations/001_create_catalog_tables.sql
psql -d smartorder -f database/migrations/002_create_orders_tables.sql
```

4. **–í–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –¥–ª—è –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
```sql
-- –í PostgreSQL –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
CREATE EXTENSION IF NOT EXISTS pg_trgm;
```

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–± - —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:**
```bash
python scripts/start_all.py
```

–°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å—Ç–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–µ—Ä–≤–∏—Å—ã:
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞ 1–° (—Å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–º)
- ‚úÖ API —Å–µ—Ä–≤–µ—Ä –∫–∞—Ç–∞–ª–æ–≥–∞
- ‚úÖ Telegram –±–æ—Ç (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω TELEGRAM_BOT_TOKEN)
- ‚úÖ –ü–∞—Ä—Å–µ—Ä –Ø–Ω–¥–µ–∫—Å.–ü–æ—á—Ç—ã (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω YANDEX_MAIL_EMAIL)
- ‚úÖ Webhook –¥–ª—è –Ø–Ω–¥–µ–∫—Å.–§–æ—Ä–º
- ‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—á–µ—Ä–µ–¥–∏ Redis
- ‚úÖ Dashboard API

**–ò–ª–∏ –∑–∞–ø—É—Å–∫ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:**

**–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞ (—Å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–º):**
```bash
python execution/sync_1c_catalog.py
```

**API —Å–µ—Ä–≤–µ—Ä –∫–∞—Ç–∞–ª–æ–≥–∞:**
```bash
python execution/api_catalog_server.py
# –ò–ª–∏ —á–µ—Ä–µ–∑ uvicorn:
uvicorn execution.api_catalog_server:app --host 0.0.0.0 --port 8025
```

**Telegram –±–æ—Ç:**
```bash
python execution/telegram_bot.py
```

**–ü–∞—Ä—Å–µ—Ä –Ø–Ω–¥–µ–∫—Å.–ü–æ—á—Ç—ã:**
```bash
python execution/yandex_mail_parser.py
```

**Webhook –¥–ª—è –Ø–Ω–¥–µ–∫—Å.–§–æ—Ä–º:**
```bash
python execution/yandex_forms_webhook.py
# –ò–ª–∏ —á–µ—Ä–µ–∑ uvicorn:
uvicorn execution.yandex_forms_webhook:app --host 0.0.0.0 --port 8026
```

**–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—á–µ—Ä–µ–¥–∏:**
```bash
python execution/queue_processor.py
```

**Dashboard API:**
```bash
python execution/dashboard_api.py
# –ò–ª–∏ —á–µ—Ä–µ–∑ uvicorn:
uvicorn execution.dashboard_api:app --host 0.0.0.0 --port 8028
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

**Health check (Catalog API):**
```bash
# Health check –¥–ª—è Catalog API
curl http://localhost:8025/health
```

**Health check (Orders API):**
```bash
# Health check –¥–ª—è Orders API
curl http://localhost:8025/api/orders/health
```

**Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- **Catalog + Orders API**: http://localhost:8025/docs (–æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
- **Dashboard API**: http://localhost:8028/docs (–æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ—Ä—Ç)

**–ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ç–∞–ª–æ–≥:**
```bash
curl http://localhost:8025/api/catalog
```

**–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤:**
```bash
curl "http://localhost:8025/api/catalog/search?q=–≤–∞—Ä–æ—á–Ω–∞—è"
```

**–¢–æ–≤–∞—Ä –ø–æ –∞—Ä—Ç–∏–∫—É–ª—É:**
```bash
curl http://localhost:8025/api/catalog/–§–†-00000044
```

**–ü–æ–ª—É—á–∏—Ç—å –∑–∞–∫–∞–∑—ã –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É (–¥–ª—è Mini App):**
```bash
curl "http://localhost:8025/api/orders/by-phone?phone=+79991234567"
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
SmartOrder Engine/
‚îú‚îÄ‚îÄ directives/              # –î–∏—Ä–µ–∫—Ç–∏–≤—ã (SOP) –¥–ª—è –∞–≥–µ–Ω—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ 1c_catalog_sync.md
‚îÇ   ‚îú‚îÄ‚îÄ 1c_export.md
‚îÇ   ‚îú‚îÄ‚îÄ ai_parsing.md
‚îÇ   ‚îú‚îÄ‚îÄ crm_orders.md
‚îÇ   ‚îú‚îÄ‚îÄ dashboard.md
‚îÇ   ‚îú‚îÄ‚îÄ delivery_payment.md
‚îÇ   ‚îú‚îÄ‚îÄ omnichannel_orders.md
‚îÇ   ‚îî‚îÄ‚îÄ yandex_mail_parsing.md
‚îú‚îÄ‚îÄ execution/               # Python —Å–∫—Ä–∏–ø—Ç—ã (–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã)
‚îÇ   ‚îú‚îÄ‚îÄ sync_1c_catalog.py      # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞ 1–°
‚îÇ   ‚îú‚îÄ‚îÄ api_catalog_server.py   # API –∫–∞—Ç–∞–ª–æ–≥–∞
‚îÇ   ‚îú‚îÄ‚îÄ telegram_bot.py          # Telegram –±–æ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ yandex_mail_parser.py   # –ü–∞—Ä—Å–µ—Ä –Ø–Ω–¥–µ–∫—Å.–ü–æ—á—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ yandex_forms_webhook.py # Webhook –Ø–Ω–¥–µ–∫—Å.–§–æ—Ä–º
‚îÇ   ‚îú‚îÄ‚îÄ queue_processor.py      # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—á–µ—Ä–µ–¥–∏ Redis
‚îÇ   ‚îú‚îÄ‚îÄ ai_order_parser.py      # AI-–ø–∞—Ä—Å–µ—Ä –∑–∞–∫–∞–∑–æ–≤ (GPT-4)
‚îÇ   ‚îú‚îÄ‚îÄ crm_service.py          # –°–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç—ã —Å –∑–∞–∫–∞–∑–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ api_orders.py           # API –∑–∞–∫–∞–∑–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ delivery_calculator.py   # –†–∞—Å—á—ë—Ç –¥–æ—Å—Ç–∞–≤–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ invoice_generator.py    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF —Å—á—ë—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ payment_processor.py    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–ø–ª–∞—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ tracking_generator.py  # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç—Ä–µ–∫-–Ω–æ–º–µ—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ 1c_exporter.py          # –≠–∫—Å–ø–æ—Ä—Ç —Å—á–µ—Ç–æ–≤ –≤ 1–°
‚îÇ   ‚îú‚îÄ‚îÄ dashboard_api.py        # Dashboard API
‚îÇ   ‚îú‚îÄ‚îÄ dashboard_frontend/     # Frontend Dashboard
‚îÇ   ‚îú‚îÄ‚îÄ data_exporter.py        # –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö (Excel, CSV, PDF)
‚îÇ   ‚îú‚îÄ‚îÄ logger_config.py        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îî‚îÄ‚îÄ migrations/          # SQL –º–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ       ‚îú‚îÄ‚îÄ 001_create_catalog_tables.sql
‚îÇ       ‚îî‚îÄ‚îÄ 002_create_orders_tables.sql
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ start_all.py         # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
‚îú‚îÄ‚îÄ docs/                    # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ Step-by-Step Guide.md
‚îÇ   ‚îú‚îÄ‚îÄ Technical Specification.md
‚îÇ   ‚îú‚îÄ‚îÄ API Documentation.md
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ logs/                    # –õ–æ–≥–∏ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è)
‚îú‚îÄ‚îÄ .tmp/                    # –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (—Å—á–µ—Ç–∞, —ç–∫—Å–ø–æ—Ä—Ç—ã)
‚îú‚îÄ‚îÄ .env                     # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å!)
‚îú‚îÄ‚îÄ .env.example             # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ requirements.txt         # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ AGENTS.md                # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –∞–≥–µ–Ω—Ç–∞
‚îî‚îÄ‚îÄ project.md               # –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–∞–ø–∫–µ `docs/`:
- **`Step-by-Step Guide.md`** - –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤
- **`Technical Specification.md`** - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ
- **`API Documentation.md`** - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
- **`Agent Benefits.md`** - –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- **`Universal 1C HTTP API Bridge.md`** - –û–ø–∏—Å–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å 1–°

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 3-—É—Ä–æ–≤–Ω–µ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É (—Å–º. `AGENTS.md`):
- **–£—Ä–æ–≤–µ–Ω—å 1: –î–∏—Ä–µ–∫—Ç–∏–≤–∞** (`directives/`) - SOP –≤ Markdown
- **–£—Ä–æ–≤–µ–Ω—å 2: –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è** - LLM-–∞–≥–µ–Ω—Ç (–ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π)
- **–£—Ä–æ–≤–µ–Ω—å 3: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ** (`execution/`) - –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ Python-—Å–∫—Ä–∏–ø—Ç—ã

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —ç—Ç–∞–ø—ã

- ‚úÖ **–≠—Ç–∞–ø 1**: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞ 1–°
- ‚úÖ **–≠—Ç–∞–ø 2**: –û–º–Ω–∏–∫–∞–Ω–∞–ª—å–Ω—ã–π –ø—Ä–∏—ë–º –∑–∞–∫–∞–∑–æ–≤ (Telegram, –Ø–Ω–¥–µ–∫—Å.–ü–æ—á—Ç–∞, –Ø–Ω–¥–µ–∫—Å.–§–æ—Ä–º—ã)
- ‚úÖ **–≠—Ç–∞–ø 3**: AI-–ø–∞—Ä—Å–∏–Ω–≥ GPT (GPT-4 –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞)
- ‚úÖ **–≠—Ç–∞–ø 4**: CRM Postgres (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏)
- ‚úÖ **–≠—Ç–∞–ø 5**: –î–æ—Å—Ç–∞–≤–∫–∞ + –û–ø–ª–∞—Ç–∞ (–ª–æ–∫–∞–ª—å–Ω–æ)
- ‚úÖ **–≠—Ç–∞–ø 6**: –ó–∞–ø–∏—Å—å –æ–±—Ä–∞—Ç–Ω–æ –≤ 1–° (—ç–∫—Å–ø–æ—Ä—Ç —Å—á–µ—Ç–æ–≤ –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã)
- ‚úÖ **–≠—Ç–∞–ø 7**: Dashboard –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞
- ‚úÖ **–≠—Ç–∞–ø 8**: –ë—ã—Å—Ç—Ä—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (Swagger, —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞, —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)

## üìä API Endpoints

### Catalog API (–ø–æ—Ä—Ç 8025)
- `GET /api/catalog` - –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
- `GET /api/catalog/search?q=...` - –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤
- `GET /api/catalog/{articul}` - –¢–æ–≤–∞—Ä –ø–æ –∞—Ä—Ç–∏–∫—É–ª—É
- `GET /health` - Health check
- `GET /docs` - Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### Orders API (–ø–æ—Ä—Ç 8025)
- `POST /api/orders` - –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
- `GET /api/orders` - –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ (—Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π)
- `GET /api/orders/by-phone?phone=...` - –ó–∞–∫–∞–∑—ã –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É (–¥–ª—è Mini App)
- `GET /api/orders/health` - Health check –¥–ª—è Orders API
- `GET /api/orders/docs` - –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- `GET /api/orders/{order_id}` - –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
- `PATCH /api/orders/{order_id}/status` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
- `GET /api/orders/{order_id}/items` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –∑–∞–∫–∞–∑–∞
- `POST /api/orders/{order_id}/generate-tracking` - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç—Ä–µ–∫-–Ω–æ–º–µ—Ä–∞
- `POST /api/payments/process/{order_id}` - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–ø–ª–∞—Ç—ã
- `GET /health` - Health check (–∫–æ—Ä–Ω–µ–≤–æ–π —É—Ä–æ–≤–µ–Ω—å)
- `GET /docs` - Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–∫–æ—Ä–Ω–µ–≤–æ–π —É—Ä–æ–≤–µ–Ω—å, –≤–∫–ª—é—á–∞–µ—Ç –≤—Å–µ API)

### Dashboard API (–ø–æ—Ä—Ç 8028)
- `GET /api/dashboard/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `GET /api/dashboard/analytics` - –î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- `GET /api/dashboard/orders` - –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤
- `GET /api/dashboard/catalog` - –ö–∞—Ç–∞–ª–æ–≥
- `GET /api/dashboard/sync-status` - –°—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ 1–°
- `GET /api/dashboard/export/orders/excel` - –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–∫–∞–∑–æ–≤ –≤ Excel
- `GET /api/dashboard/export/orders/csv` - –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–∫–∞–∑–æ–≤ –≤ CSV
- `GET /api/dashboard/export/stats/pdf` - –≠–∫—Å–ø–æ—Ä—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ PDF
- `GET /api/dashboard/export/analytics/pdf` - –≠–∫—Å–ø–æ—Ä—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤ PDF
- `GET /api/dashboard/export/catalog/excel` - –≠–∫—Å–ø–æ—Ä—Ç –∫–∞—Ç–∞–ª–æ–≥–∞ –≤ Excel
- `GET /api/dashboard/export/catalog/csv` - –≠–∫—Å–ø–æ—Ä—Ç –∫–∞—Ç–∞–ª–æ–≥–∞ –≤ CSV
- `GET /health` - Health check
- `GET /docs` - Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### Webhook (–ø–æ—Ä—Ç 8026)
- `POST /webhook/yandex-forms` - Webhook –¥–ª—è –Ø–Ω–¥–µ–∫—Å.–§–æ—Ä–º
- `GET /health` - Health check

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ JSON –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `logs/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- –§–æ—Ä–º–∞—Ç: JSON (–≤ —Ñ–∞–π–ª–∞—Ö) –∏–ª–∏ —á–∏—Ç–∞–µ–º—ã–π —Ç–µ–∫—Å—Ç (–≤ –∫–æ–Ω—Å–æ–ª–∏)
- –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è (10 MB, 5 —Ñ–∞–π–ª–æ–≤)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è: `LOG_JSON_FORMAT=true/false`

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
```python
from execution.logger_config import get_logger

logger = get_logger(__name__)
logger.info("Message", extra={"key": "value"})
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ —Ñ–∞–π–ª–µ `.env`. –°–º. `.env.example` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
- `DATABASE_URL` - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
- `REDIS_URL` - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Redis
- `ONEC_BASE_URL` - URL 1–° HTTP Service
- `ONEC_USERNAME`, `ONEC_PASSWORD` - –£—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ 1–°
- `OPENAI_API_KEY` - –ö–ª—é—á OpenAI API
- `OPENAI_MODEL` - –ú–æ–¥–µ–ª—å GPT (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: gpt-4.1-mini)
- `OPENAI_BASE_URL` - Base URL –¥–ª—è OpenAI API
- `TELEGRAM_BOT_TOKEN` - –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
- `YANDEX_MAIL_EMAIL`, `YANDEX_MAIL_PASSWORD` - –£—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ø–Ω–¥–µ–∫—Å.–ü–æ—á—Ç—ã

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ 1–°
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `ONEC_BASE_URL`, `ONEC_USERNAME`, `ONEC_PASSWORD`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ 1–° HTTP Service –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∞–π—Ä–≤–æ–ª–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ endpoint: `/hs/api/get/catalog/` –∏ `/hs/invoices`

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_URL`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î
- –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏: `001_create_catalog_tables.sql` –∏ `002_create_orders_tables.sql`

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis
- Redis –æ–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω (–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—á–µ—Ä–µ–¥—å)
- –ï—Å–ª–∏ Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –î–ª—è —Ä–∞–±–æ—Ç—ã –æ—á–µ—Ä–µ–¥–∏ Redis –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `REDIS_URL`

### –ü—Ä–æ–±–ª–µ–º–∞: AI-–ø–∞—Ä—Å–µ—Ä –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `OPENAI_API_KEY`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `OPENAI_BASE_URL` (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–æ–∫—Å–∏)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏–º–∏—Ç—ã API OpenAI
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `logs/ai_order_parser.log`

### –ü—Ä–æ–±–ª–µ–º–∞: Telegram –±–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `TELEGRAM_BOT_TOKEN`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `logs/telegram_bot.log`

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ `logs/`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ health check endpoints: `/health`
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ API: `/docs`

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —ç—Ç–∞–ø—ã

- ‚è≥ **–≠—Ç–∞–ø 9**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
- ‚è≥ **–≠—Ç–∞–ø 10**: Telegram Mini App (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- ‚è≥ **–≠—Ç–∞–ø 11**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã
- ‚è≥ **–≠—Ç–∞–ø 12**: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ (Deployment) - –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
- ‚è≥ **–≠—Ç–∞–ø 13**: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ - –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
- ‚è≥ **–≠—Ç–∞–ø 14**: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –æ–±—É—á–µ–Ω–∏–µ

---

**–£–¥–∞—á–∏ –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ SmartOrder Engine! üöÄ**