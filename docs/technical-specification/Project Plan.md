# План проекта: SmartOrder Engine

## 1. Общая информация

**Версия документа**: v1.0  
**Дата**: 13.02.2026

---

## 2. Этапы разработки

| Этап | Описание | Срок | Приоритет |
|------|----------|------|-----------|
| Этап 1 | Синхронизация каталога 1С | 1 неделя | Высокий |
| Этап 2 | Омниканальный приём заказов | 2 недели | Высокий |
| Этап 3 | AI-парсинг GPT | 2 недели | Высокий |
| Этап 4 | CRM Postgres | 1 неделя | Высокий |
| Этап 5 | Доставка + Оплата | 1 неделя | Средний |
| Этап 6 | Экспорт в 1С | 1 неделя | Средний |
| Этап 7 | Dashboard | 2 недели | Низкий |

**Общий срок**: 10 недель

---

## 3. Минимально жизнеспособный продукт (MVP)

### 3.1. Состав MVP
- Этап 1: Синхронизация каталога 1С
- Этап 2: Омниканальный приём заказов
- Этап 3: AI-парсинг GPT
- Этап 4: CRM Postgres

### 3.2. Срок MVP
**6 недель**

### 3.3. Цель MVP
Получить работающую систему для автоматической обработки заказов с базовой функциональностью, позволяющую протестировать концепцию и получить обратную связь от пользователей.

---

## 4. Детальное описание этапов

### 4.1. Этап 1: Синхронизация каталога 1С
**Срок**: 1 неделя  
**Приоритет**: Высокий

**Задачи**:
- Настройка подключения к 1С HTTP Service
- Реализация синхронизации каталога товаров
- Создание схемы БД для хранения товаров
- Реализация API endpoint для доступа к каталогу
- Настройка автоматической синхронизации (каждые 30 минут)
- Обработка ошибок и логирование

**Результат**: Работающая синхронизация каталога с 1С и API для доступа к данным

---

### 4.2. Этап 2: Омниканальный приём заказов
**Срок**: 2 недели  
**Приоритет**: Высокий

**Задачи**:
- Разработка Telegram бота
- Реализация IMAP парсера для Яндекс.Почты
- Реализация Webhook для Яндекс.Форм
- Настройка единой очереди обработки
- Реализация Queue Processor
- Тестирование всех каналов

**Результат**: Все каналы приёма заказов работают и отправляют данные в единую очередь

---

### 4.3. Этап 3: AI-парсинг GPT
**Срок**: 2 недели  
**Приоритет**: Высокий

**Задачи**:
- Интеграция с AI API (OpenAI GPT-4)
- Реализация парсинга неструктурированного текста
- Реализация fuzzy matching для сопоставления товаров
- Валидация данных и остатков
- Генерация уточняющих вопросов
- Реализация fallback механизмов (regex)
- Тестирование точности парсинга

**Результат**: Работающий AI-парсер с точностью ≥ 90%

---

### 4.4. Этап 4: CRM Postgres
**Срок**: 1 неделя  
**Приоритет**: Высокий

**Задачи**:
- Проектирование схемы БД для заказов
- Реализация CRUD операций для заказов
- Реализация системы статусов
- Реализация REST API для работы с заказами
- Реализация фильтрации, поиска, пагинации
- Тестирование API

**Результат**: Полнофункциональная CRM система с API

---

### 4.5. Этап 5: Доставка + Оплата
**Срок**: 1 неделя  
**Приоритет**: Средний

**Задачи**:
- Реализация расчёта стоимости доставки
- Реализация генерации PDF счетов
- Реализация fake системы оплаты
- Генерация трек-номеров
- Интеграция с каналами связи для отправки счетов и трек-номеров

**Результат**: Полный цикл от создания счёта до отправки товара

---

### 4.6. Этап 6: Экспорт в 1С
**Срок**: 1 неделя  
**Приоритет**: Средний

**Задачи**:
- Реализация экспорта счетов в 1С (при статусе "invoice_created")
- Реализация экспорта заказов в 1С (при статусе "paid")
- Реализация retry логики
- Реализация dead letter queue
- Логирование всех экспортов

**Результат**: Двусторонняя синхронизация с 1С

---

### 4.7. Этап 7: Dashboard
**Срок**: 2 недели  
**Приоритет**: Низкий

**Задачи**:
- Разработка интерфейса Dashboard
- Реализация просмотра и фильтрации заказов
- Реализация управления статусами
- Реализация статистики в реальном времени
- Реализация просмотра каталога с остатками
- Тестирование интерфейса

**Результат**: Полнофункциональный Dashboard для менеджеров

---

## 5. Зависимости между этапами

```
Этап 1 (Каталог) 
    ↓
Этап 2 (Приём заказов) → Этап 3 (AI-парсинг) → Этап 4 (CRM)
    ↓                                              ↓
Этап 5 (Доставка + Оплата) ← ← ← ← ← ← ← ← ← ← ← ←
    ↓
Этап 6 (Экспорт в 1С)
    ↓
Этап 7 (Dashboard) - может разрабатываться параллельно с этапами 5-6
```

---

## 6. Риски и митигация

### 6.1. Риски сроков

| Риск | Вероятность | Влияние | Митигация |
|------|-------------|---------|-----------|
| Задержка интеграции с 1С | Средняя | Высокое | Начать работу с 1С командой заранее, использовать mock данные для разработки |
| Проблемы с AI API | Средняя | Среднее | Иметь запасной план с fallback механизмами |
| Изменение требований | Высокая | Среднее | Гибкая архитектура, регулярные синхронизации с заказчиком |

### 6.2. Управление рисками
- Еженедельные статус-митинги
- Раннее выявление проблем
- Гибкое планирование с возможностью перераспределения ресурсов

---

## 7. Критерии готовности этапов

### 7.1. Общие критерии
- ✅ Все функциональные требования этапа реализованы
- ✅ Код протестирован (unit тесты, integration тесты)
- ✅ Документация обновлена
- ✅ Код прошёл code review
- ✅ Нет критических багов

### 7.2. Специфические критерии
См. документ "Acceptance Criteria.md" для детальных критериев приёмки каждого этапа.

---

**Конец документа**
